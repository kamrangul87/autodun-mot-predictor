<script>
  const form = document.getElementById("mot-form");
  const resultContainer = document.getElementById("result-container");
  const submitBtn = document.getElementById("submit-btn");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    resultContainer.innerHTML = "";
    submitBtn.disabled = true;

    const vehicle_age = parseFloat(document.getElementById("vehicle_age").value);
    const mileage = parseFloat(document.getElementById("mileage").value);

    try {
      const res = await fetch("/api/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ vehicle_age, mileage }),
      });

      const data = await res.json();

      const prob = data.pass_probability;
      const risk = data.risk_level;

      let html = `<div class="result">
        <strong>Prediction result</strong><br/>
        Estimated probability of passing: ${(prob * 100).toFixed(1)}%<br/>
        Risk level: ${risk}
      </div>`;

      resultContainer.innerHTML = html;
    } catch (err) {
      resultContainer.innerHTML = `<div class="error">
        Could not get prediction.<br/>
        ${err}
      </div>`;
    } finally {
      submitBtn.disabled = false;
    }
  });
</script>
